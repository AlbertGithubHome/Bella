*本文主要总结一些项目开发中遇到需要改进的部分，也就是写代码让人感觉到不爽的地方，当前项目肯定是改不了了，下个项目应该也没戏，期待着有一天可以实现这些修改，记录在此，方便日后修改或者重建，一切为了进步！*

# 服务器改进

1. 将货币和道具统一，方便判断和扣除，定制统一接口，可以简化开发代码 *——2018-11-07 12:09:00*

2. PK模式是个值得整理的地方，PK模式与NPC间的关系   *——2018-11-07 12:09:00*

3. 服务器需要一个定时器    *——2018-11-20 16:18:01*

4. 考虑Id和字符串转换的意义，不是以节省空间和流量的转换都是耍流氓     *——2018-12-01 16:57:30*

5. BUFF系统很强大，但是BUFF EVENT使用混乱，通常造成结果不确定性     *——2018-12-07 12:14:16*

6. 道具的模板id，4位id有些浪费，初步设想改为3位id      *——2018-12-26 13:58:00*
 - 理论上使用一个整数就足够了，但是这样就浪费了一些分类信息，也不利于分段管理，初步设想改为3位id，是参考目前4位id来改进的，目前的4位id配置的比较混乱，除了第一位以外，其他的信息几乎是随便填的，也就是说虽然分了后3位id，但是和一个数字没有什么区别，3位id的分配，id1使用1字节，id2使用1字节，id3使用2字节，这样整个物品的id可以使用一个字节的整数来表示，方便函数传递和网络传输。3位id只出现在配置表中，方便配置人员参考，进入游戏系统后均转为4字节的一位id

7. 发送ShowPredefPramMsg的参数是`int msgId, int argc, char * argv[]`类型，导致很多常量字符串都要报警告，建议改成`const char * argv[]`

8. 迫切需要各个系统增加数据改变通知，提供注册接口，例：等级变化，经验变化，装备变化     *——2019-4-9 10:48:03*

9. 为方便的逻辑代码，可将玩家数据查询接口封装至一个代理类，统一查找入口，例：装备强化次数，玩家最大等级   *——2019-4-9 10:48:03*

10. 需要一套调试系统，可以自由调节个人数据和系统数据，比如开服天数，个人子系统数据 *——2019-7-22 11:50:09*

11. 主要的游戏对象自身需要包含调试信息，比如一个道具被删除时需要记录被何处调用删除，用来查询删除错误时产生的BUG *——2019-8-12 18:13:13*

12. BUFF增益、减益效果导致原有的伤害监控、死亡归属可能失效 *——2019-9-11 16:54:04*

13. 数据库表的名字最好统一命名为小写字母，避免Windows和linux两个平台对于大小写的区分不一样导致的问题 *——2019-9-17 10:07:20*

14. 长长的列表最后都要加个检查位，方便查找问题和自动化检查 *——2019-12-3 10:49:38*

# 服务器闪光点

1. KLinkArray的实现，数组加链，将索引使用控制在值较小的范围内，可以保证尽可能使用值比较小的索引 *——2020-1-6 16:15:53*
 - 应用范围：道具索引的m_FreeIdx和m_UseIdx，玩家索引的m_FreeIdx和m_UseIdx，Obj索引的m_FreeIdx和m_UseIdx，队伍ID的m_UseIdx



# 客户端改进

1. 关于UI层级，需要划分几类，控制好每一类的界面层级范围，保证大类之间的层级正确，同级之间控制不要同时显示 *——2020-1-2 14:15:09*

2. 游戏内UI对象在返回登录界面的时候并没有回收，如果快速再次进入游戏，会保留之前存储的数据，需要注意这一点，或者不保存中间数据，不依赖OnCreate函数 *——2020-1-6 13:29:48*

# 需求改变

1. 我们的厉害之处就是看遍了市场上所有的需求变化，却从未进入过市场   *——2018-12-12 20:52:48*


# 需要规避的问题

1. 紧急情况下需要杜绝处女座洁癖的性格，追求完美有时候会导致一事无成 *——2019-8-19 17:36:36*
 - 记一次上线前游戏包发布……

2. 头脑一热的修改带来的往往是不可控的灾难，已知的问题常常比未知的修改更让人放心 *——2019-11-13 09:28:20*
 - 记一次上线前游戏临时修改（游戏任务）……

# 有所思考

1. 大部分时候针对于数据单元测试和数据本身是一个相互检测的过程 *——2019-9-11 11:23:46*
 - 正常一般情况下，单元测试报错说明数据填错了，如果确认数据是对的，那么就是单元测试的逻辑错了

2. 不做过多的假设，不添加过分的扩展，事实证明，你现在的想到的大部分扩展在后续开发过程中都是用不到的，白白浪费了时间 *——2019-9-16 10:04:24*

3. 有时候适度的未雨绸缪是必要的，就比如这次的元宵活动，我感觉春节回来再做是完全可以的，但是没想到爆发了武汉疫情，开工回来已经过完了元宵节，幸好之前有人坚持再做 *——2020-2-7 17:27:23*