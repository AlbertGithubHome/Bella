*继上传了linux_command.md之后，发现个人对命令的敏感度提高了不少，因为平时工作在windows环境，使用的windows命令也不少，索性也总结到一起吧。本文主要总结一些用到的windows命令，做这个总结主要是为了便于后续查找，因为自己在工作过程中也用过不少的命令，一般在反复使用的那段时间，命令记得特别熟，但是稍微搁置几天就有些记不清了，所以萌生了总结到一起的想法，初步的思路就是用到哪些就记录哪些，没有什么先后顺序和层次关系，只要方便查找就好，一切为了进步！*

# 系统命令
1.查看arp缓存

- **arp -a**
- **arp -d**

```cmd
C:\Users\Administrator>arp -a

接口: 192.168.1.105 --- 0xb
  Internet 地址         物理地址              类型
  192.168.1.1           7c-1c-f1-d4-94-b2     动态
  192.168.1.9           30-5a-3a-7d-4d-f1     动态
  192.168.1.16          08-62-66-86-99-e9     动态
  192.168.1.18          9c-5c-8e-95-4d-64     动态
  192.168.1.22          08-62-66-87-0b-54     动态
  192.168.1.26          30-5a-3a-80-eb-d2     动态
  192.168.1.28          f0-79-59-95-cf-a0     动态
  192.168.1.31          9c-5c-8e-95-4d-76     动态
  192.168.1.34          30-5a-3a-81-f4-8a     动态
  192.168.1.35          9c-5c-8e-96-b6-94     动态
  192.168.1.38          08-62-66-7e-a7-ba     动态
  192.168.1.39          00-25-90-20-a0-2a     动态
  192.168.1.43          08-62-66-87-0b-59     动态
  192.168.1.49          9c-5c-8e-96-b2-2e     动态
  192.168.1.54          2c-56-dc-9c-ae-f9     动态
  192.168.1.57          70-4d-7b-b1-8b-c7     动态
  192.168.1.58          d0-17-c2-93-90-cb     动态
  192.168.1.60          14-dd-a9-de-d3-4a     动态
  192.168.1.61          40-61-86-f8-9c-be     动态
  192.168.1.62          d0-17-c2-93-a6-bb     动态
  192.168.1.68          fc-aa-14-7e-31-2e     动态
  192.168.1.70          18-03-73-38-ee-64     动态
  192.168.1.71          14-dd-a9-e0-7c-ab     动态
  192.168.1.84          2c-56-dc-9c-ae-f8     动态
  192.168.1.94          f0-79-59-db-f4-eb     动态
  192.168.1.106         00-0b-2f-87-f8-14     动态
  192.168.1.107         30-5a-3a-7b-e2-09     动态
  192.168.1.108         30-5a-3a-7b-ea-39     动态
  192.168.1.109         18-03-73-38-d6-8a     动态
  192.168.1.111         00-0b-2f-87-b3-6a     动态
  192.168.1.115         f0-79-59-db-f5-3d     动态
  192.168.1.116         18-03-73-38-eb-04     动态
  192.168.1.119         fc-d7-33-47-22-77     动态
  192.168.1.120         44-8a-5b-94-ef-6b     动态
  192.168.1.127         1c-b7-2c-de-39-f8     动态
  192.168.1.136         14-dd-a9-de-d6-e8     动态
  192.168.1.144         30-5a-3a-7e-25-9f     动态
  192.168.1.150         d0-17-c2-98-72-94     动态
  192.168.1.151         18-03-73-38-e6-55     动态
  192.168.1.152         14-dd-a9-e7-eb-0f     动态
  192.168.1.155         18-03-73-38-eb-2c     动态
  192.168.1.166         30-5a-3a-e0-9d-43     动态
  192.168.1.167         14-dd-a9-df-71-84     动态
  192.168.1.168         f0-79-59-95-c9-f1     动态
  192.168.1.169         30-5a-3a-80-ec-35     动态
  192.168.1.172         30-5a-3a-7b-eb-13     动态
  192.168.1.174         18-03-73-38-d6-90     动态
  192.168.1.176         d0-17-c2-99-b0-c8     动态
  192.168.1.177         30-5a-3a-81-f4-7e     动态
  192.168.1.181         18-03-73-38-f1-69     动态
  192.168.1.188         14-dd-a9-ea-61-4d     动态
  192.168.1.189         08-62-66-7e-a7-ae     动态
  192.168.1.192         14-dd-a9-e0-7c-c7     动态
  192.168.1.193         00-21-5e-f0-33-24     动态
  192.168.1.197         fc-aa-14-4b-9f-44     动态
  192.168.1.198         1c-b7-2c-dd-b0-7f     动态
  192.168.1.199         9c-5c-8e-96-ae-06     动态
  192.168.1.200         14-dd-a9-df-61-2d     动态
  192.168.1.207         d4-3d-7e-0f-a5-9e     动态
  192.168.1.209         00-1f-d0-06-7b-68     动态
  192.168.1.212         14-dd-a9-de-d6-fa     动态
  192.168.1.213         00-30-48-5f-59-a6     动态
  192.168.1.215         00-21-5e-f0-62-ee     动态
  192.168.1.218         08-00-37-e4-33-f0     动态
  192.168.1.224         f0-79-59-db-f5-39     动态
  192.168.1.229         9c-5c-8e-95-48-06     动态
  192.168.1.231         00-21-b7-6a-c9-55     动态
  192.168.1.233         08-62-66-86-a1-16     动态
  192.168.1.238         08-62-66-85-fa-d2     动态
  192.168.1.255         ff-ff-ff-ff-ff-ff     静态
  224.0.0.22            01-00-5e-00-00-16     静态
  224.0.0.251           01-00-5e-00-00-fb     静态
  224.0.0.252           01-00-5e-00-00-fc     静态
  229.190.201.113       01-00-5e-3e-c9-71     静态
  230.0.0.1             01-00-5e-00-00-01     静态
  230.100.0.113         01-00-5e-64-00-71     静态
  233.53.67.39          01-00-5e-35-43-27     静态
  235.200.22.121        01-00-5e-48-16-79     静态
  239.11.20.1           01-00-5e-0b-14-01     静态
  255.255.255.255       ff-ff-ff-ff-ff-ff     静态
```

这就是我电脑arp的缓存情况，如果想清空使用`arp -d`即可

2. 显示套接字内容

- **netstat -nao**

```cmd
C:\Users\Administrator>netstat -nao

活动连接

  协议  本地地址          外部地址        状态           PID
  TCP    0.0.0.0:135            0.0.0.0:0              LISTENING       800
  TCP    0.0.0.0:445            0.0.0.0:0              LISTENING       4
  TCP    0.0.0.0:1025           0.0.0.0:0              LISTENING       632
  TCP    0.0.0.0:1026           0.0.0.0:0              LISTENING       1064
  TCP    0.0.0.0:1027           0.0.0.0:0              LISTENING       744
  TCP    0.0.0.0:1028           0.0.0.0:0              LISTENING       1160
  TCP    0.0.0.0:1031           0.0.0.0:0              LISTENING       736
  TCP    0.0.0.0:1034           0.0.0.0:0              LISTENING       3424
  TCP    0.0.0.0:2425           0.0.0.0:0              LISTENING       5092
  TCP    0.0.0.0:3306           0.0.0.0:0              LISTENING       1524
  TCP    0.0.0.0:8080           0.0.0.0:0              LISTENING       4
  TCP    0.0.0.0:8090           0.0.0.0:0              LISTENING       4
  TCP    0.0.0.0:27036          0.0.0.0:0              LISTENING       4132
  TCP    0.0.0.0:30985          0.0.0.0:0              LISTENING       5092
  TCP    0.0.0.0:31105          0.0.0.0:0              LISTENING       2496
  TCP    0.0.0.0:35729          0.0.0.0:0              LISTENING       1252
  TCP    0.0.0.0:47984          0.0.0.0:0              LISTENING       3704
  TCP    0.0.0.0:47989          0.0.0.0:0              LISTENING       3704
  TCP    0.0.0.0:48010          0.0.0.0:0              LISTENING       3704
  TCP    127.0.0.1:1102         127.0.0.1:65001        ESTABLISHED     3704
  TCP    127.0.0.1:1515         127.0.0.1:1516         ESTABLISHED     5768
  ...
```

显示了协议类型、计算机本身ip和端口，对方的ip和端口，通讯状态、进程id
其中0.0.0.0表示通讯还没开始
a显示所有套接字
n显示ip和端口
o显示使用套接字的进程id


3. 打印路由信息

- **route print**

```cmd
C:\Users\Administrator>route print
===========================================================================
接口列表
 11...2c 56 dc 9a 85 98 ......Realtek PCIe GBE Family Controller
  1...........................Software Loopback Interface 1
 12...00 00 00 00 00 00 00 e0 Microsoft ISATAP Adapter
 13...00 00 00 00 00 00 00 e0 Teredo Tunneling Pseudo-Interface
===========================================================================

IPv4 路由表
===========================================================================
活动路由:
网络目标        网络掩码          网关       接口   跃点数
          0.0.0.0          0.0.0.0      192.168.1.1    192.168.1.105    276
        127.0.0.0        255.0.0.0            在链路上         127.0.0.1    306
        127.0.0.1  255.255.255.255            在链路上         127.0.0.1    306
  127.255.255.255  255.255.255.255            在链路上         127.0.0.1    306
      192.168.1.0    255.255.255.0            在链路上     192.168.1.105    276
    192.168.1.105  255.255.255.255            在链路上     192.168.1.105    276
    192.168.1.255  255.255.255.255            在链路上     192.168.1.105    276
        224.0.0.0        240.0.0.0            在链路上         127.0.0.1    306
        224.0.0.0        240.0.0.0            在链路上     192.168.1.105    276
  255.255.255.255  255.255.255.255            在链路上         127.0.0.1    306
  255.255.255.255  255.255.255.255            在链路上     192.168.1.105    276
===========================================================================
永久路由:
  网络地址          网络掩码  网关地址  跃点数
          0.0.0.0          0.0.0.0      192.168.1.1     默认
===========================================================================

IPv6 路由表
===========================================================================
活动路由:
 如果跃点数网络目标      网关
  1    306 ::1/128                  在链路上
  1    306 ff00::/8                 在链路上
===========================================================================
永久路由:
  无
```

以上就是路由信息表了，具体数据还不太理解。

4. 查询显卡信息

- **nvidia-smi**

```cmd
C:\Program Files\NVIDIA Corporation\NVSMI>nvidia-smi
Fri Jul 27 10:05:24 2018
+------------------------------------------------------+
| NVIDIA-SMI 364.72     Driver Version: 364.72         |
|-------------------------------+----------------------+----------------------+
| GPU  Name            TCC/WDDM | Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|===============================+======================+======================|
|   0  GeForce GTX 750 Ti WDDM  | 0000:01:00.0      On |                  N/A |
| 33%   33C    P8     1W / 100W |    485MiB /  2048MiB |      4%      Default |
+-------------------------------+----------------------+----------------------+

+-----------------------------------------------------------------------------+
| Processes:                                                       GPU Memory |
|  GPU       PID  Type  Process name                               Usage      |
|=============================================================================|
|    0       576  C+G   Insufficient Permissions                     N/A      |
|    0      1396  C+G   C:\Windows\system32\Dwm.exe                  N/A      |
|    0      5424  C+G   ...m Files (x86)\Mozilla Firefox\firefox.exe N/A      |
|    0      6488  C+G   ...x86)\Youdao\YoudaoNote\YNoteCefRender.exe N/A      |
|    0      6804  C+G   ...Steam\bin\cef\cef.win7\steamwebhelper.exe N/A      |
|    0      8452  C+G   ...m Files (x86)\Mozilla Firefox\firefox.exe N/A      |
|    0      9380  C+G   ...m Files (x86)\Mozilla Firefox\firefox.exe N/A      |
|    0      9568  C+G   ...m Files (x86)\Mozilla Firefox\firefox.exe N/A      |
|    0     10148  C+G   ...m Files (x86)\Mozilla Firefox\firefox.exe N/A      |
+-----------------------------------------------------------------------------+
```

这个命令实际上是调用NVIDIA的程序，如果这个程序加到了环境变量中，直接在cmd串口输入即可，
否则需要进入到安装目录执行，默认安装目录一般是`C:\Program Files\NVIDIA Corporation\NVSMI>`

5. 查询程序或DLL所在位置

- **where msvcp140.dll**

```cmd
C:\Program Files\NVIDIA Corporation\NVSMI>where msvcp140.dll
C:\Windows\System32\msvcp140.dll
H:\Program Files\TortoiseSVN\bin\msvcp140.dll
```

where 命令后面直接跟需要查找的程序或者DLL即可

6. 定时关机

- **shutdown /s /t 3600**

```cmd
C:\Users\Administrator>shutdown /s /t 7200

C:\Users\Administrator>shutdown /s /t 7200
已经计划系统关机。(1190)
```

实际上这个命令是延时关机，最后面的数字就是距离关机的时间（单位：秒），第一次敲命令时命令窗口没有反馈，但是系统右下角会给出2小时后关机的提醒，这时延时关机就已经生效了，再次输入命令就会得到“已经计划系统关机。(1190)”的提醒。

7. 打开组策略面板

- **gpedit**

```cmd
C:\Users\Administrator>gpedit

```

敲完命令回车后就会打开本地组策略编辑器，gpedit本身应该是GroupPolicy Edit的缩写，主要用于配置一些策略信息，比如开关机运行脚本，就可以在“本地计算机 策略->计算机配置->Windows 设置 ->脚本（启动/关机）”中进行配置。[示例开关机脚本](https://github.com/AlbertGithubHome/Bella/tree/master/bat/watchdog)

8. 创建目录链接

- **mklink /J newName sourceName**

```cmd
E:\batTool>mklink /?
创建符号链接。

MKLINK [[/D] | [/H] | [/J]] Link Target

        /D      创建目录符号链接。默认为文件
                符号链接。
        /H      创建硬链接而非符号链接。
        /J      创建目录联接。
        Link    指定新的符号链接名称。
        Target  指定新链接引用的路径
                (相对或绝对)。

E:\batTool>mklink /J gitref ../GitProject
无效开关 - "GitProject"。

E:\batTool>mklink /J gitref ..\GitProject
为 gitref <<===>> ..\GitProject 创建的联接

```

需要注意的是这个命令与linux下的`ln`命令的区别，是新创建链接文件的名字是在前面的，与linux下命令是反的，很容易记错，如上面例子就是新建了链接文件gitref指向了外层目录GitProject，实际上是多了一个对GitProject目录的引用，与快捷方式不同

还有一点需要注意下，就是在windows10版本下的PowerShell中不识别这个命令，必须使用cmd才可以


# 工具命令

1. 查看dll中的符号信息

- **dumpbin**

```
C:\Program Files (x86)\Microsoft Visual Studio 14.0\VC\bin>dumpbin -exports G:\msvcp90d.dll > G:\msvcp90d.txt
```

dumpbin是Visual Studio自带的工具，一般没有放到环境变量中，所以要进入对应的目录使用，如果这个目录在环境变量中，
则可以在任何目录下使用，按照上述格式将dll中的函数符号导出到对应的查看文件中

2. 查看lib文件中的符号信息

- **dumpbin**

```
C:\Program Files (x86)\Microsoft Visual Studio 14.0\VC\bin>dumpbin /all  G:\test.lib> G:\test.txt
```

参考查看dll信息就可以，但是使用`-exports`选项不行，需要`/all`选项

# 图形操作界面

这些图形界面一般直接使用快捷键Win+R，然后敲击命令回车后即可打开对应操作界面，简单方便。

1. 打开系统信息

- **msinfo32**

2. 打开控制面板

- **control**

3. 查询Windows激活信息

-- **slmgr.vbs -dlv**